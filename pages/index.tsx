import React from 'react'
import Head from 'next/head'
import styles from '../styles/Home.module.css'
import { Network, Alchemy } from 'alchemy-sdk'
import NftFeed from '../components/NftFeed'

const settings = {
    apiKey: process.env.ALCHEMY_API_KEY,
    network: Network.ETH_MAINNET,
};

const alchemy = new Alchemy(settings);

export async function getStaticProps() {
  // Get all the NFTs owned by an address
  const response = await alchemy.nft.getNftsForContract("0xB003ce92F3b2A8F3dd99207C351eAf05BC605262");

  // retrieving spamInfo, metadataError and contract causes error
  const nfts: any = response.nfts.map((nft) => {
    const { spamInfo, metadataError, contract, ...rest } = nft;
    return rest;
  });

  return {
    props: {nfts}
  }
}

export default function Home(props: any) {
  return (
    <div className={styles.container}>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <header>
        <h1>20Mint NFT Displayer</h1>
      </header>

      <main className={styles.main}>
        <NftFeed nfts={props.nfts}/>
      </main>

      {/* <footer className={styles.footer}>
      </footer> */}
    </div>
  )
}
